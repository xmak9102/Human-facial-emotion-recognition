data and label torch.Size([1, 28, 28]) 5
Epoch 0:   8%|█▍                | 150/1875 [00:01<00:16, 101.81it/s, loss=0.4, v_num=vn10]
GPU available: False, used: False
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
  | Name  | Type  | Params
--------------------------------
0 | model | Model | 7.9 K
--------------------------------
7.9 K     Trainable params
0         Non-trainable params
7.9 K     Total params






Epoch 0:  84%|████████████▌  | 1574/1875 [00:15<00:02, 101.48it/s, loss=0.293, v_num=vn10]








Epoch 1:  88%|█████████████▏ | 1648/1875 [00:15<00:02, 104.58it/s, loss=0.268, v_num=vn10]








Epoch 2:  92%|█████████████▊ | 1726/1875 [00:16<00:01, 106.15it/s, loss=0.255, v_num=vn10]

Testing DataLoader 0:   0%|                                       | 0/312 [00:00<?, ?it/s]
FIT Profiler Report
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
|  Action                                                                                                                                                                                                    	|  Mean duration (s)	|  Num calls      	|  Total time (s) 	|  Percentage %   	|
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
|  Total                                                                                                                                                                                                     	|  -              	|  200563         	|  53.137         	|  100 %          	|
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
|  run_training_epoch                                                                                                                                                                                        	|  17.671         	|  3              	|  53.013         	|  99.767         	|
|  run_training_batch                                                                                                                                                                                        	|  0.0023087      	|  4500           	|  10.389         	|  19.551         	|
|  [LightningModule]PL_module.optimizer_step                                                                                                                                                                 	|  0.0020208      	|  4500           	|  9.0936         	|  17.113         	|
|  on_train_batch_end                                                                                                                                                                                        	|  0.0010896      	|  4500           	|  4.9031         	|  9.2274         	|
|  [Strategy]SingleDeviceStrategy.training_step                                                                                                                                                              	|  0.00063581     	|  4500           	|  2.8611         	|  5.3844         	|
|  [Strategy]SingleDeviceStrategy.backward                                                                                                                                                                   	|  0.00043508     	|  4500           	|  1.9579         	|  3.6846         	|
|  [Callback]TQDMProgressBar.on_validation_batch_end                                                                                                                                                         	|  0.00081582     	|  1127           	|  0.91943        	|  1.7303         	|
|  on_train_batch_start                                                                                                                                                                                      	|  0.00017559     	|  4500           	|  0.79016        	|  1.487          	|
|  [Strategy]SingleDeviceStrategy.validation_step                                                                                                                                                            	|  0.00067618     	|  1127           	|  0.76205        	|  1.4341         	|
|  [LightningModule]PL_module.optimizer_zero_grad                                                                                                                                                            	|  7.6667e-05     	|  4500           	|  0.345          	|  0.64926        	|
|  [Strategy]SingleDeviceStrategy.batch_to_device                                                                                                                                                            	|  4.6509e-05     	|  5627           	|  0.2617         	|  0.49251        	|
|  [Callback]TQDMProgressBar.on_validation_batch_start                                                                                                                                                       	|  2.3921e-05     	|  1127           	|  0.026959       	|  0.050735       	|
|  [Callback]TQDMProgressBar.on_after_backward                                                                                                                                                               	|  5.6174e-06     	|  4500           	|  0.025278       	|  0.047572       	|
|  [Callback]TQDMProgressBar.on_before_zero_grad                                                                                                                                                             	|  5.5344e-06     	|  4500           	|  0.024905       	|  0.046869       	|
|  [Callback]TQDMProgressBar.on_batch_end                                                                                                                                                                    	|  5.1016e-06     	|  4500           	|  0.022957       	|  0.043204       	|
|  [Callback]TQDMProgressBar.on_batch_start                                                                                                                                                                  	|  5.0942e-06     	|  4500           	|  0.022924       	|  0.043141       	|
|  [Callback]TQDMProgressBar.on_before_backward                                                                                                                                                              	|  4.3434e-06     	|  4500           	|  0.019545       	|  0.036783       	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_after_backward                  	|  4.22e-06       	|  4500           	|  0.01899        	|  0.035738       	|
|  [Callback]ModelSummary.on_validation_batch_end                                                                                                                                                            	|  1.6139e-05     	|  1127           	|  0.018189       	|  0.03423        	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_batch_end                       	|  4.034e-06      	|  4500           	|  0.018153       	|  0.034162       	|
|  [Callback]TQDMProgressBar.on_before_optimizer_step                                                                                                                                                        	|  3.9619e-06     	|  4500           	|  0.017829       	|  0.033552       	|
|  [Callback]ModelSummary.on_batch_start                                                                                                                                                                     	|  3.8972e-06     	|  4500           	|  0.017538       	|  0.033004       	|
|  [Callback]ModelSummary.on_before_zero_grad                                                                                                                                                                	|  3.8349e-06     	|  4500           	|  0.017257       	|  0.032477       	|
|  [Callback]GradientAccumulationScheduler.on_after_backward                                                                                                                                                 	|  3.8292e-06     	|  4500           	|  0.017231       	|  0.032428       	|
|  [Callback]ModelSummary.on_after_backward                                                                                                                                                                  	|  3.8115e-06     	|  4500           	|  0.017152       	|  0.032278       	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_batch_start                     	|  3.7793e-06     	|  4500           	|  0.017007       	|  0.032006       	|
|  [Callback]ModelSummary.on_batch_end                                                                                                                                                                       	|  3.7369e-06     	|  4500           	|  0.016816       	|  0.031646       	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_before_zero_grad                	|  3.6968e-06     	|  4500           	|  0.016636       	|  0.031307       	|
|  [Callback]GradientAccumulationScheduler.on_batch_end                                                                                                                                                      	|  3.589e-06      	|  4500           	|  0.016151       	|  0.030394       	|
|  [Callback]ModelSummary.on_before_backward                                                                                                                                                                 	|  3.5818e-06     	|  4500           	|  0.016118       	|  0.030333       	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_before_backward                 	|  3.5602e-06     	|  4500           	|  0.016021       	|  0.03015        	|
|  [Callback]GradientAccumulationScheduler.on_batch_start                                                                                                                                                    	|  3.5455e-06     	|  4500           	|  0.015955       	|  0.030026       	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_before_optimizer_step           	|  3.419e-06      	|  4500           	|  0.015385       	|  0.028954       	|
|  [Callback]GradientAccumulationScheduler.on_before_zero_grad                                                                                                                                               	|  3.3317e-06     	|  4500           	|  0.014993       	|  0.028215       	|
|  [Callback]ModelSummary.on_before_optimizer_step                                                                                                                                                           	|  3.3294e-06     	|  4500           	|  0.014982       	|  0.028196       	|
|  [Callback]GradientAccumulationScheduler.on_before_backward                                                                                                                                                	|  3.169e-06      	|  4500           	|  0.014261       	|  0.026837       	|
|  [Callback]GradientAccumulationScheduler.on_before_optimizer_step                                                                                                                                          	|  3.1572e-06     	|  4500           	|  0.014208       	|  0.026737       	|
|  [LightningModule]PL_module.on_train_batch_end                                                                                                                                                             	|  2.4806e-06     	|  4500           	|  0.011163       	|  0.021007       	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_train_epoch_end                 	|  0.0035313      	|  3              	|  0.010594       	|  0.019937       	|
|  [LightningModule]PL_module.training_step_end                                                                                                                                                              	|  2.2887e-06     	|  4500           	|  0.010299       	|  0.019383       	|
|  [LightningModule]PL_module.on_train_batch_start                                                                                                                                                           	|  1.962e-06      	|  4500           	|  0.0088292      	|  0.016616       	|
|  [LightningModule]PL_module.on_before_zero_grad                                                                                                                                                            	|  1.8742e-06     	|  4500           	|  0.0084341      	|  0.015872       	|
|  [LightningModule]PL_module.training_epoch_end                                                                                                                                                             	|  0.0024792      	|  3              	|  0.0074377      	|  0.013997       	|
|  [Strategy]SingleDeviceStrategy.training_step_end                                                                                                                                                          	|  1.5913e-06     	|  4500           	|  0.0071607      	|  0.013476       	|
|  [Strategy]SingleDeviceStrategy.on_train_batch_start                                                                                                                                                       	|  1.5492e-06     	|  4500           	|  0.0069715      	|  0.01312        	|
|  [LightningModule]PL_module.on_before_backward                                                                                                                                                             	|  1.5457e-06     	|  4500           	|  0.0069555      	|  0.01309        	|
|  [LightningModule]PL_module.on_after_backward                                                                                                                                                              	|  1.5194e-06     	|  4500           	|  0.0068371      	|  0.012867       	|
|  [Callback]GradientAccumulationScheduler.on_validation_batch_end                                                                                                                                           	|  5.5827e-06     	|  1127           	|  0.0062917      	|  0.011841       	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_validation_batch_end            	|  5.481e-06      	|  1127           	|  0.0061771      	|  0.011625       	|
|  [LightningModule]PL_module.on_before_optimizer_step                                                                                                                                                       	|  1.2945e-06     	|  4500           	|  0.0058254      	|  0.010963       	|
|  [Callback]ModelSummary.on_validation_batch_start                                                                                                                                                          	|  4.7196e-06     	|  1127           	|  0.005319       	|  0.01001        	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_validation_batch_start          	|  4.0771e-06     	|  1127           	|  0.0045949      	|  0.0086473      	|
|  [Callback]GradientAccumulationScheduler.on_validation_batch_start                                                                                                                                         	|  3.8121e-06     	|  1127           	|  0.0042962      	|  0.0080851      	|
|  [LightningModule]PL_module.validation_step_end                                                                                                                                                            	|  2.5087e-06     	|  1127           	|  0.0028273      	|  0.0053208      	|
|  [LightningModule]PL_module.on_validation_batch_end                                                                                                                                                        	|  2.3953e-06     	|  1127           	|  0.0026995      	|  0.0050803      	|
|  [Callback]TQDMProgressBar.on_train_epoch_end                                                                                                                                                              	|  0.00084377     	|  3              	|  0.0025313      	|  0.0047637      	|
|  [Callback]TQDMProgressBar.on_validation_end                                                                                                                                                               	|  0.00051287     	|  4              	|  0.0020515      	|  0.0038608      	|
|  [LightningModule]PL_module.on_validation_batch_start                                                                                                                                                      	|  1.816e-06      	|  1127           	|  0.0020466      	|  0.0038515      	|
|  [Strategy]SingleDeviceStrategy.validation_step_end                                                                                                                                                        	|  1.7449e-06     	|  1127           	|  0.0019665      	|  0.0037008      	|
|  [Callback]TQDMProgressBar.on_validation_start                                                                                                                                                             	|  0.00037413     	|  4              	|  0.0014965      	|  0.0028163      	|
|  [Callback]TQDMProgressBar.on_train_epoch_start                                                                                                                                                            	|  0.00043777     	|  3              	|  0.0013133      	|  0.0024715      	|
|  [Callback]TQDMProgressBar.on_sanity_check_start                                                                                                                                                           	|  0.0012291      	|  1              	|  0.0012291      	|  0.0023131      	|
|  [Callback]ModelSummary.on_fit_start                                                                                                                                                                       	|  0.0004839      	|  1              	|  0.0004839      	|  0.00091066     	|
|  [Callback]TQDMProgressBar.on_train_end                                                                                                                                                                    	|  0.0004362      	|  1              	|  0.0004362      	|  0.0008209      	|
|  [Callback]TQDMProgressBar.on_train_start                                                                                                                                                                  	|  0.0002586      	|  1              	|  0.0002586      	|  0.00048667     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': None}.setup                              	|  0.0002385      	|  1              	|  0.0002385      	|  0.00044884     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_validation_end                  	|  5.3025e-05     	|  4              	|  0.0002121      	|  0.00039916     	|
|  [LightningModule]PL_module.on_validation_model_train                                                                                                                                                      	|  4.7625e-05     	|  4              	|  0.0001905      	|  0.00035851     	|
|  [LightningModule]PL_module.on_validation_model_eval                                                                                                                                                       	|  4.2575e-05     	|  4              	|  0.0001703      	|  0.00032049     	|
|  [LightningModule]PL_module.configure_optimizers                                                                                                                                                           	|  9.15e-05       	|  1              	|  9.15e-05       	|  0.0001722      	|
|  [Callback]ModelSummary.on_validation_end                                                                                                                                                                  	|  1.5325e-05     	|  4              	|  6.13e-05       	|  0.00011536     	|
|  [Callback]ModelSummary.on_validation_start                                                                                                                                                                	|  1.235e-05      	|  4              	|  4.94e-05       	|  9.2967e-05     	|
|  [Callback]ModelSummary.on_train_epoch_end                                                                                                                                                                 	|  1.4533e-05     	|  3              	|  4.36e-05       	|  8.2052e-05     	|
|  [Callback]TQDMProgressBar.on_validation_epoch_start                                                                                                                                                       	|  9.125e-06      	|  4              	|  3.65e-05       	|  6.869e-05      	|
|  [Callback]TQDMProgressBar.on_epoch_end                                                                                                                                                                    	|  4.9286e-06     	|  7              	|  3.45e-05       	|  6.4926e-05     	|
|  [Callback]TQDMProgressBar.on_epoch_start                                                                                                                                                                  	|  4.8429e-06     	|  7              	|  3.39e-05       	|  6.3797e-05     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_validation_epoch_end            	|  8.15e-06       	|  4              	|  3.26e-05       	|  6.1351e-05     	|
|  [Callback]ModelSummary.on_train_epoch_start                                                                                                                                                               	|  1.01e-05       	|  3              	|  3.03e-05       	|  5.7022e-05     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_epoch_end                       	|  4.3e-06        	|  7              	|  3.01e-05       	|  5.6646e-05     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_epoch_start                     	|  4.1e-06        	|  7              	|  2.87e-05       	|  5.4011e-05     	|
|  [Callback]ModelSummary.on_epoch_end                                                                                                                                                                       	|  3.8571e-06     	|  7              	|  2.7e-05        	|  5.0812e-05     	|
|  [Callback]ModelSummary.on_epoch_start                                                                                                                                                                     	|  3.5714e-06     	|  7              	|  2.5e-05        	|  4.7048e-05     	|
|  [Callback]GradientAccumulationScheduler.on_epoch_end                                                                                                                                                      	|  3.4714e-06     	|  7              	|  2.43e-05       	|  4.5731e-05     	|
|  [Callback]GradientAccumulationScheduler.on_train_epoch_start                                                                                                                                              	|  7.9e-06        	|  3              	|  2.37e-05       	|  4.4602e-05     	|
|  [Callback]TQDMProgressBar.on_save_checkpoint                                                                                                                                                              	|  7.6667e-06     	|  3              	|  2.3e-05        	|  4.3284e-05     	|
|  [Callback]GradientAccumulationScheduler.on_epoch_start                                                                                                                                                    	|  3.2286e-06     	|  7              	|  2.26e-05       	|  4.2532e-05     	|
|  [Callback]GradientAccumulationScheduler.on_validation_start                                                                                                                                               	|  5.475e-06      	|  4              	|  2.19e-05       	|  4.1214e-05     	|
|  [Callback]GradientAccumulationScheduler.on_validation_end                                                                                                                                                 	|  5.275e-06      	|  4              	|  2.11e-05       	|  3.9709e-05     	|
|  [Callback]ModelSummary.on_sanity_check_start                                                                                                                                                              	|  1.94e-05       	|  1              	|  1.94e-05       	|  3.6509e-05     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_validation_start                	|  4.85e-06       	|  4              	|  1.94e-05       	|  3.6509e-05     	|
|  [Callback]ModelSummary.on_validation_epoch_start                                                                                                                                                          	|  4.5e-06        	|  4              	|  1.8e-05        	|  3.3875e-05     	|
|  [Callback]GradientAccumulationScheduler.on_validation_epoch_start                                                                                                                                         	|  4.5e-06        	|  4              	|  1.8e-05        	|  3.3875e-05     	|
|  [Callback]TQDMProgressBar.on_validation_epoch_end                                                                                                                                                         	|  4.025e-06      	|  4              	|  1.61e-05       	|  3.0299e-05     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_save_checkpoint                 	|  5.3667e-06     	|  3              	|  1.61e-05       	|  3.0299e-05     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_train_epoch_start               	|  5.1333e-06     	|  3              	|  1.54e-05       	|  2.8982e-05     	|
|  [Callback]ModelSummary.on_save_checkpoint                                                                                                                                                                 	|  4.7e-06        	|  3              	|  1.41e-05       	|  2.6535e-05     	|
|  [Callback]ModelSummary.on_validation_epoch_end                                                                                                                                                            	|  3.425e-06      	|  4              	|  1.37e-05       	|  2.5782e-05     	|
|  [LightningModule]PL_module.on_validation_end                                                                                                                                                              	|  3.2e-06        	|  4              	|  1.28e-05       	|  2.4089e-05     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_validation_epoch_start          	|  3.1e-06        	|  4              	|  1.24e-05       	|  2.3336e-05     	|
|  [Callback]GradientAccumulationScheduler.on_train_epoch_end                                                                                                                                                	|  4.1333e-06     	|  3              	|  1.24e-05       	|  2.3336e-05     	|
|  [Callback]GradientAccumulationScheduler.on_validation_epoch_end                                                                                                                                           	|  3.025e-06      	|  4              	|  1.21e-05       	|  2.2771e-05     	|
|  [LightningModule]PL_module.on_epoch_start                                                                                                                                                                 	|  1.6e-06        	|  7              	|  1.12e-05       	|  2.1078e-05     	|
|  [Callback]GradientAccumulationScheduler.on_save_checkpoint                                                                                                                                                	|  3.6667e-06     	|  3              	|  1.1e-05        	|  2.0701e-05     	|
|  [Callback]TQDMProgressBar.setup                                                                                                                                                                           	|  1.09e-05       	|  1              	|  1.09e-05       	|  2.0513e-05     	|
|  [Callback]ModelSummary.on_train_end                                                                                                                                                                       	|  1.06e-05       	|  1              	|  1.06e-05       	|  1.9948e-05     	|
|  [LightningModule]PL_module.on_epoch_end                                                                                                                                                                   	|  1.5143e-06     	|  7              	|  1.06e-05       	|  1.9948e-05     	|
|  [Callback]TQDMProgressBar.on_before_accelerator_backend_setup                                                                                                                                             	|  1.02e-05       	|  1              	|  1.02e-05       	|  1.9196e-05     	|
|  [Callback]GradientAccumulationScheduler.on_fit_start                                                                                                                                                      	|  9.9e-06        	|  1              	|  9.9e-06        	|  1.8631e-05     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_sanity_check_start              	|  9.9e-06        	|  1              	|  9.9e-06        	|  1.8631e-05     	|
|  [LightningModule]PL_module.on_train_epoch_end                                                                                                                                                             	|  3.1667e-06     	|  3              	|  9.5e-06        	|  1.7878e-05     	|
|  [Callback]GradientAccumulationScheduler.on_sanity_check_end                                                                                                                                               	|  8.6e-06        	|  1              	|  8.6e-06        	|  1.6185e-05     	|
|  [LightningModule]PL_module.on_validation_start                                                                                                                                                            	|  2.075e-06      	|  4              	|  8.3e-06        	|  1.562e-05      	|
|  [LightningModule]PL_module.validation_epoch_end                                                                                                                                                           	|  2.075e-06      	|  4              	|  8.3e-06        	|  1.562e-05      	|
|  [Callback]ModelSummary.on_train_start                                                                                                                                                                     	|  8.3e-06        	|  1              	|  8.3e-06        	|  1.562e-05      	|
|  [Callback]TQDMProgressBar.on_sanity_check_end                                                                                                                                                             	|  7.6e-06        	|  1              	|  7.6e-06        	|  1.4303e-05     	|
|  [Strategy]SingleDeviceStrategy.on_validation_start                                                                                                                                                        	|  1.9e-06        	|  4              	|  7.6e-06        	|  1.4303e-05     	|
|  [Callback]TQDMProgressBar.on_fit_end                                                                                                                                                                      	|  7.4e-06        	|  1              	|  7.4e-06        	|  1.3926e-05     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_fit_start                       	|  7.1e-06        	|  1              	|  7.1e-06        	|  1.3362e-05     	|
|  [LightningModule]PL_module.on_fit_start                                                                                                                                                                   	|  6.9e-06        	|  1              	|  6.9e-06        	|  1.2985e-05     	|
|  [LightningModule]PL_module.on_save_checkpoint                                                                                                                                                             	|  2.1667e-06     	|  3              	|  6.5e-06        	|  1.2233e-05     	|
|  [Callback]TQDMProgressBar.on_fit_start                                                                                                                                                                    	|  6.3e-06        	|  1              	|  6.3e-06        	|  1.1856e-05     	|
|  [Strategy]SingleDeviceStrategy.on_validation_end                                                                                                                                                          	|  1.575e-06      	|  4              	|  6.3e-06        	|  1.1856e-05     	|
|  [LightningModule]PL_module.on_validation_epoch_end                                                                                                                                                        	|  1.55e-06       	|  4              	|  6.2e-06        	|  1.1668e-05     	|
|  [Callback]GradientAccumulationScheduler.on_before_accelerator_backend_setup                                                                                                                               	|  6.1e-06        	|  1              	|  6.1e-06        	|  1.148e-05      	|
|  [Callback]GradientAccumulationScheduler.setup                                                                                                                                                             	|  6e-06          	|  1              	|  6e-06          	|  1.1292e-05     	|
|  [Callback]ModelSummary.on_before_accelerator_backend_setup                                                                                                                                                	|  5.9e-06        	|  1              	|  5.9e-06        	|  1.1103e-05     	|
|  [LightningModule]PL_module.configure_callbacks                                                                                                                                                            	|  5.7e-06        	|  1              	|  5.7e-06        	|  1.0727e-05     	|
|  [LightningModule]PL_module.on_validation_epoch_start                                                                                                                                                      	|  1.4e-06        	|  4              	|  5.6e-06        	|  1.0539e-05     	|
|  [Callback]GradientAccumulationScheduler.on_sanity_check_start                                                                                                                                             	|  5.4e-06        	|  1              	|  5.4e-06        	|  1.0162e-05     	|
|  [Callback]TQDMProgressBar.teardown                                                                                                                                                                        	|  5.2e-06        	|  1              	|  5.2e-06        	|  9.786e-06      	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': None}.on_before_accelerator_backend_setup	|  5.1e-06        	|  1              	|  5.1e-06        	|  9.5978e-06     	|
|  [LightningModule]PL_module.on_train_epoch_start                                                                                                                                                           	|  1.7e-06        	|  3              	|  5.1e-06        	|  9.5978e-06     	|
|  [Callback]TQDMProgressBar.on_pretrain_routine_start                                                                                                                                                       	|  5e-06          	|  1              	|  5e-06          	|  9.4096e-06     	|
|  [Callback]ModelSummary.setup                                                                                                                                                                              	|  4.9e-06        	|  1              	|  4.9e-06        	|  9.2214e-06     	|
|  [Callback]GradientAccumulationScheduler.on_train_end                                                                                                                                                      	|  4.7e-06        	|  1              	|  4.7e-06        	|  8.845e-06      	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_train_end                       	|  4.5e-06        	|  1              	|  4.5e-06        	|  8.4687e-06     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_fit_end                         	|  4.2e-06        	|  1              	|  4.2e-06        	|  7.9041e-06     	|
|  [Callback]ModelSummary.on_fit_end                                                                                                                                                                         	|  4.1e-06        	|  1              	|  4.1e-06        	|  7.7159e-06     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.teardown                           	|  4.1e-06        	|  1              	|  4.1e-06        	|  7.7159e-06     	|
|  [LightningModule]PL_module.setup                                                                                                                                                                          	|  3.9e-06        	|  1              	|  3.9e-06        	|  7.3395e-06     	|
|  [Callback]ModelSummary.teardown                                                                                                                                                                           	|  3.9e-06        	|  1              	|  3.9e-06        	|  7.3395e-06     	|
|  [Callback]GradientAccumulationScheduler.teardown                                                                                                                                                          	|  3.8e-06        	|  1              	|  3.8e-06        	|  7.1513e-06     	|
|  [LightningModule]PL_module.on_val_dataloader                                                                                                                                                              	|  3.8e-06        	|  1              	|  3.8e-06        	|  7.1513e-06     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_train_start                     	|  3.7e-06        	|  1              	|  3.7e-06        	|  6.9631e-06     	|
|  [Callback]TQDMProgressBar.on_configure_sharded_model                                                                                                                                                      	|  3.4e-06        	|  1              	|  3.4e-06        	|  6.3985e-06     	|
|  [Callback]GradientAccumulationScheduler.on_fit_end                                                                                                                                                        	|  3.4e-06        	|  1              	|  3.4e-06        	|  6.3985e-06     	|
|  [Callback]ModelSummary.on_pretrain_routine_start                                                                                                                                                          	|  3.1e-06        	|  1              	|  3.1e-06        	|  5.834e-06      	|
|  [Callback]ModelSummary.on_sanity_check_end                                                                                                                                                                	|  3e-06          	|  1              	|  3e-06          	|  5.6458e-06     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_pretrain_routine_start          	|  2.9e-06        	|  1              	|  2.9e-06        	|  5.4576e-06     	|
|  [Callback]GradientAccumulationScheduler.on_train_start                                                                                                                                                    	|  2.9e-06        	|  1              	|  2.9e-06        	|  5.4576e-06     	|
|  [LightningModule]PL_module.prepare_data                                                                                                                                                                   	|  2.8e-06        	|  1              	|  2.8e-06        	|  5.2694e-06     	|
|  [LightningModule]PL_module.on_train_dataloader                                                                                                                                                            	|  2.6e-06        	|  1              	|  2.6e-06        	|  4.893e-06      	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_configure_sharded_model         	|  2.6e-06        	|  1              	|  2.6e-06        	|  4.893e-06      	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_sanity_check_end                	|  2.6e-06        	|  1              	|  2.6e-06        	|  4.893e-06      	|
|  [Callback]GradientAccumulationScheduler.on_pretrain_routine_start                                                                                                                                         	|  2.5e-06        	|  1              	|  2.5e-06        	|  4.7048e-06     	|
|  [Callback]TQDMProgressBar.on_pretrain_routine_end                                                                                                                                                         	|  2.5e-06        	|  1              	|  2.5e-06        	|  4.7048e-06     	|
|  [Callback]ModelSummary.on_configure_sharded_model                                                                                                                                                         	|  2.4e-06        	|  1              	|  2.4e-06        	|  4.5166e-06     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_pretrain_routine_end            	|  2.4e-06        	|  1              	|  2.4e-06        	|  4.5166e-06     	|
|  [Callback]GradientAccumulationScheduler.on_configure_sharded_model                                                                                                                                        	|  2.3e-06        	|  1              	|  2.3e-06        	|  4.3284e-06     	|
|  [Callback]ModelSummary.on_pretrain_routine_end                                                                                                                                                            	|  2.2e-06        	|  1              	|  2.2e-06        	|  4.1402e-06     	|
|  [Callback]GradientAccumulationScheduler.on_pretrain_routine_end                                                                                                                                           	|  2.2e-06        	|  1              	|  2.2e-06        	|  4.1402e-06     	|
|  [LightningModule]PL_module.on_train_end                                                                                                                                                                   	|  2e-06          	|  1              	|  2e-06          	|  3.7638e-06     	|
|  [LightningModule]PL_module.on_fit_end                                                                                                                                                                     	|  2e-06          	|  1              	|  2e-06          	|  3.7638e-06     	|
|  [LightningModule]PL_module.teardown                                                                                                                                                                       	|  1.9e-06        	|  1              	|  1.9e-06        	|  3.5757e-06     	|
|  [LightningModule]PL_module.configure_sharded_model                                                                                                                                                        	|  1.8e-06        	|  1              	|  1.8e-06        	|  3.3875e-06     	|
|  [Strategy]SingleDeviceStrategy.on_train_end                                                                                                                                                               	|  1.6e-06        	|  1              	|  1.6e-06        	|  3.0111e-06     	|
|  [LightningModule]PL_module.on_pretrain_routine_start                                                                                                                                                      	|  1.3e-06        	|  1              	|  1.3e-06        	|  2.4465e-06     	|
|  [LightningModule]PL_module.on_train_start                                                                                                                                                                 	|  1.2e-06        	|  1              	|  1.2e-06        	|  2.2583e-06     	|
|  [Strategy]SingleDeviceStrategy.on_train_start                                                                                                                                                             	|  1e-06          	|  1              	|  1e-06          	|  1.8819e-06     	|
|  [LightningModule]PL_module.on_pretrain_routine_end                                                                                                                                                        	|  8e-07          	|  1              	|  8e-07          	|  1.5055e-06     	|
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Traceback (most recent call last):
  File "/home/xps/educate/code/hust/ML/PL_tutorial/Basic/logger.py", line 112, in <module>
    trainer.test(model, test_loader)
  File "/home/xps/anaconda3/envs/deeplearning/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 936, in test
    return self._call_and_handle_interrupt(self._test_impl, model, dataloaders, ckpt_path, verbose, datamodule)
  File "/home/xps/anaconda3/envs/deeplearning/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 721, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/xps/anaconda3/envs/deeplearning/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 983, in _test_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/xps/anaconda3/envs/deeplearning/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 1234, in _run
    results = self._run_stage()
  File "/home/xps/anaconda3/envs/deeplearning/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 1318, in _run_stage
    return self._run_evaluate()
  File "/home/xps/anaconda3/envs/deeplearning/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 1363, in _run_evaluate
    eval_loop_results = self._evaluation_loop.run()
  File "/home/xps/anaconda3/envs/deeplearning/lib/python3.9/site-packages/pytorch_lightning/loops/base.py", line 204, in run
    self.advance(*args, **kwargs)
  File "/home/xps/anaconda3/envs/deeplearning/lib/python3.9/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 154, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/home/xps/anaconda3/envs/deeplearning/lib/python3.9/site-packages/pytorch_lightning/loops/base.py", line 204, in run
    self.advance(*args, **kwargs)
  File "/home/xps/anaconda3/envs/deeplearning/lib/python3.9/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 127, in advance
    output = self._evaluation_step(**kwargs)
  File "/home/xps/anaconda3/envs/deeplearning/lib/python3.9/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 220, in _evaluation_step
    output = self.trainer._call_strategy_hook("test_step", *kwargs.values())
  File "/home/xps/anaconda3/envs/deeplearning/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 1763, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/xps/anaconda3/envs/deeplearning/lib/python3.9/site-packages/pytorch_lightning/strategies/strategy.py", line 352, in test_step
    return self.model.test_step(*args, **kwargs)
  File "/home/xps/educate/code/hust/ML/PL_tutorial/Basic/logger.py", line 89, in test_step
    self.log("Image", wandb.Image(plot, caption='test_image'))
  File "/home/xps/anaconda3/envs/deeplearning/lib/python3.9/site-packages/pytorch_lightning/core/lightning.py", line 366, in log
    apply_to_collection(
  File "/home/xps/anaconda3/envs/deeplearning/lib/python3.9/site-packages/pytorch_lightning/utilities/apply_func.py", line 99, in apply_to_collection
    return function(data, *args, **kwargs)
  File "/home/xps/anaconda3/envs/deeplearning/lib/python3.9/site-packages/pytorch_lightning/core/lightning.py", line 531, in __check_allowed
    raise ValueError(f"`self.log({name}, {value})` was called, but `{type(v).__name__}` values cannot be logged")
