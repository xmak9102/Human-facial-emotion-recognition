data and label torch.Size([1, 28, 28]) 2
Epoch 0:   7%|█▏               | 134/1875 [00:01<00:18, 91.94it/s, loss=0.387, v_num=uhtg]
GPU available: False, used: False
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
  | Name  | Type  | Params
--------------------------------
0 | model | Model | 7.9 K
--------------------------------
7.9 K     Trainable params
0         Non-trainable params
7.9 K     Total params







Epoch 0:  90%|██████████████▎ | 1680/1875 [00:17<00:02, 95.19it/s, loss=0.378, v_num=uhtg]









Epoch 1:  90%|██████████████▍ | 1692/1875 [00:18<00:01, 92.43it/s, loss=0.363, v_num=uhtg]








Epoch 2:  80%|████████████▊   | 1503/1875 [00:16<00:04, 91.89it/s, loss=0.353, v_num=uhtg]

Validation DataLoader 0:  64%|████████████████▌         | 239/375 [00:02<00:01, 88.74it/s]
FIT Profiler Report
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
|  Action                                                                                                                                                                                                    	|  Mean duration (s)	|  Num calls      	|  Total time (s) 	|  Percentage %   	|
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
|  Total                                                                                                                                                                                                     	|  -              	|  200563         	|  58.96          	|  100 %          	|
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
|  run_training_epoch                                                                                                                                                                                        	|  19.582         	|  3              	|  58.745         	|  99.635         	|
|  run_training_batch                                                                                                                                                                                        	|  0.0027249      	|  4500           	|  12.262         	|  20.798         	|
|  [LightningModule]PL_module.optimizer_step                                                                                                                                                                 	|  0.0023817      	|  4500           	|  10.718         	|  18.178         	|
|  on_train_batch_end                                                                                                                                                                                        	|  0.001243       	|  4500           	|  5.5936         	|  9.4872         	|
|  [Strategy]SingleDeviceStrategy.training_step                                                                                                                                                              	|  0.00076182     	|  4500           	|  3.4282         	|  5.8145         	|
|  [Strategy]SingleDeviceStrategy.backward                                                                                                                                                                   	|  0.0005347      	|  4500           	|  2.4061         	|  4.081          	|
|  [Callback]TQDMProgressBar.on_validation_batch_end                                                                                                                                                         	|  0.00092052     	|  1127           	|  1.0374         	|  1.7595         	|
|  on_train_batch_start                                                                                                                                                                                      	|  0.00020146     	|  4500           	|  0.90659        	|  1.5376         	|
|  [Strategy]SingleDeviceStrategy.validation_step                                                                                                                                                            	|  0.00072086     	|  1127           	|  0.81241        	|  1.3779         	|
|  [LightningModule]PL_module.optimizer_zero_grad                                                                                                                                                            	|  9.0301e-05     	|  4500           	|  0.40636        	|  0.68921        	|
|  [Strategy]SingleDeviceStrategy.batch_to_device                                                                                                                                                            	|  5.3184e-05     	|  5627           	|  0.29927        	|  0.50758        	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_train_epoch_end                 	|  0.016209       	|  3              	|  0.048627       	|  0.082475       	|
|  [Callback]TQDMProgressBar.on_after_backward                                                                                                                                                               	|  6.5154e-06     	|  4500           	|  0.029319       	|  0.049727       	|
|  [Callback]TQDMProgressBar.on_before_zero_grad                                                                                                                                                             	|  5.8247e-06     	|  4500           	|  0.026211       	|  0.044456       	|
|  [Callback]TQDMProgressBar.on_batch_start                                                                                                                                                                  	|  5.553e-06      	|  4500           	|  0.024988       	|  0.042382       	|
|  [Callback]TQDMProgressBar.on_batch_end                                                                                                                                                                    	|  5.5335e-06     	|  4500           	|  0.024901       	|  0.042233       	|
|  [Callback]TQDMProgressBar.on_before_backward                                                                                                                                                              	|  4.5999e-06     	|  4500           	|  0.0207         	|  0.035108       	|
|  [Callback]TQDMProgressBar.on_before_optimizer_step                                                                                                                                                        	|  4.4502e-06     	|  4500           	|  0.020026       	|  0.033965       	|
|  [Callback]ModelSummary.on_after_backward                                                                                                                                                                  	|  4.3556e-06     	|  4500           	|  0.0196         	|  0.033243       	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_batch_start                     	|  4.3195e-06     	|  4500           	|  0.019438       	|  0.032968       	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_batch_end                       	|  4.2585e-06     	|  4500           	|  0.019163       	|  0.032502       	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_before_zero_grad                	|  4.1677e-06     	|  4500           	|  0.018754       	|  0.031809       	|
|  [Callback]ModelSummary.on_before_zero_grad                                                                                                                                                                	|  4.135e-06      	|  4500           	|  0.018607       	|  0.031559       	|
|  [Callback]ModelSummary.on_batch_start                                                                                                                                                                     	|  4.0166e-06     	|  4500           	|  0.018075       	|  0.030656       	|
|  [Callback]ModelSummary.on_validation_batch_end                                                                                                                                                            	|  1.5979e-05     	|  1127           	|  0.018008       	|  0.030542       	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_before_optimizer_step           	|  3.9448e-06     	|  4500           	|  0.017751       	|  0.030108       	|
|  [Callback]ModelSummary.on_batch_end                                                                                                                                                                       	|  3.9042e-06     	|  4500           	|  0.017569       	|  0.029798       	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_before_backward                 	|  3.9034e-06     	|  4500           	|  0.017565       	|  0.029792       	|
|  [LightningModule]PL_module.training_epoch_end                                                                                                                                                             	|  0.0058115      	|  3              	|  0.017434       	|  0.02957        	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_after_backward                  	|  3.8673e-06     	|  4500           	|  0.017403       	|  0.029517       	|
|  [Callback]GradientAccumulationScheduler.on_batch_end                                                                                                                                                      	|  3.8104e-06     	|  4500           	|  0.017147       	|  0.029082       	|
|  [Callback]GradientAccumulationScheduler.on_before_backward                                                                                                                                                	|  3.7466e-06     	|  4500           	|  0.01686        	|  0.028595       	|
|  [Callback]GradientAccumulationScheduler.on_before_optimizer_step                                                                                                                                          	|  3.6675e-06     	|  4500           	|  0.016504       	|  0.027992       	|
|  [Callback]ModelSummary.on_before_backward                                                                                                                                                                 	|  3.6578e-06     	|  4500           	|  0.01646        	|  0.027918       	|
|  [Callback]GradientAccumulationScheduler.on_after_backward                                                                                                                                                 	|  3.6293e-06     	|  4500           	|  0.016332       	|  0.0277         	|
|  [Callback]ModelSummary.on_before_optimizer_step                                                                                                                                                           	|  3.596e-06      	|  4500           	|  0.016182       	|  0.027446       	|
|  [Callback]GradientAccumulationScheduler.on_before_zero_grad                                                                                                                                               	|  3.5706e-06     	|  4500           	|  0.016068       	|  0.027252       	|
|  [Callback]GradientAccumulationScheduler.on_batch_start                                                                                                                                                    	|  3.5033e-06     	|  4500           	|  0.015765       	|  0.026738       	|
|  [Callback]TQDMProgressBar.on_validation_batch_start                                                                                                                                                       	|  1.2476e-05     	|  1127           	|  0.01406        	|  0.023847       	|
|  [LightningModule]PL_module.on_train_batch_end                                                                                                                                                             	|  2.662e-06      	|  4500           	|  0.011979       	|  0.020317       	|
|  [LightningModule]PL_module.training_step_end                                                                                                                                                              	|  2.4368e-06     	|  4500           	|  0.010965       	|  0.018598       	|
|  [LightningModule]PL_module.on_train_batch_start                                                                                                                                                           	|  2.0666e-06     	|  4500           	|  0.0092997      	|  0.015773       	|
|  [LightningModule]PL_module.on_before_zero_grad                                                                                                                                                            	|  2.0031e-06     	|  4500           	|  0.0090141      	|  0.015289       	|
|  [Strategy]SingleDeviceStrategy.on_train_batch_start                                                                                                                                                       	|  1.7002e-06     	|  4500           	|  0.0076507      	|  0.012976       	|
|  [Strategy]SingleDeviceStrategy.training_step_end                                                                                                                                                          	|  1.6867e-06     	|  4500           	|  0.0075903      	|  0.012874       	|
|  [LightningModule]PL_module.on_after_backward                                                                                                                                                              	|  1.6651e-06     	|  4500           	|  0.0074929      	|  0.012708       	|
|  [LightningModule]PL_module.on_before_backward                                                                                                                                                             	|  1.6437e-06     	|  4500           	|  0.0073966      	|  0.012545       	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_validation_batch_end            	|  5.9242e-06     	|  1127           	|  0.0066766      	|  0.011324       	|
|  [LightningModule]PL_module.on_before_optimizer_step                                                                                                                                                       	|  1.4625e-06     	|  4500           	|  0.0065811      	|  0.011162       	|
|  [Callback]GradientAccumulationScheduler.on_validation_batch_end                                                                                                                                           	|  5.7449e-06     	|  1127           	|  0.0064745      	|  0.010981       	|
|  [Callback]ModelSummary.on_validation_batch_start                                                                                                                                                          	|  4.9849e-06     	|  1127           	|  0.005618       	|  0.0095285      	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_validation_batch_start          	|  4.5705e-06     	|  1127           	|  0.005151       	|  0.0087365      	|
|  [Callback]GradientAccumulationScheduler.on_validation_batch_start                                                                                                                                         	|  3.9868e-06     	|  1127           	|  0.0044931      	|  0.0076206      	|
|  [Callback]TQDMProgressBar.on_validation_end                                                                                                                                                               	|  0.000838       	|  4              	|  0.003352       	|  0.0056852      	|
|  [LightningModule]PL_module.validation_step_end                                                                                                                                                            	|  2.6846e-06     	|  1127           	|  0.0030255      	|  0.0051315      	|
|  [LightningModule]PL_module.on_validation_batch_end                                                                                                                                                        	|  2.6204e-06     	|  1127           	|  0.0029532      	|  0.0050088      	|
|  [LightningModule]PL_module.on_validation_batch_start                                                                                                                                                      	|  1.9756e-06     	|  1127           	|  0.0022265      	|  0.0037763      	|
|  [Callback]TQDMProgressBar.on_train_epoch_end                                                                                                                                                              	|  0.00071097     	|  3              	|  0.0021329      	|  0.0036175      	|
|  [Strategy]SingleDeviceStrategy.validation_step_end                                                                                                                                                        	|  1.8456e-06     	|  1127           	|  0.00208        	|  0.0035278      	|
|  [Callback]TQDMProgressBar.on_train_epoch_start                                                                                                                                                            	|  0.00062907     	|  3              	|  0.0018872      	|  0.0032008      	|
|  [Callback]TQDMProgressBar.on_validation_start                                                                                                                                                             	|  0.00030553     	|  4              	|  0.0012221      	|  0.0020728      	|
|  [Callback]TQDMProgressBar.on_sanity_check_start                                                                                                                                                           	|  0.0010896      	|  1              	|  0.0010896      	|  0.001848       	|
|  [Callback]ModelSummary.on_fit_start                                                                                                                                                                       	|  0.0009153      	|  1              	|  0.0009153      	|  0.0015524      	|
|  [Callback]TQDMProgressBar.on_train_start                                                                                                                                                                  	|  0.0004017      	|  1              	|  0.0004017      	|  0.00068131     	|
|  [Callback]TQDMProgressBar.on_train_end                                                                                                                                                                    	|  0.0003445      	|  1              	|  0.0003445      	|  0.0005843      	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': None}.setup                              	|  0.0003379      	|  1              	|  0.0003379      	|  0.0005731      	|
|  [LightningModule]PL_module.on_validation_model_train                                                                                                                                                      	|  5.15e-05       	|  4              	|  0.000206       	|  0.00034939     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_validation_end                  	|  4.185e-05      	|  4              	|  0.0001674      	|  0.00028392     	|
|  [LightningModule]PL_module.on_validation_model_eval                                                                                                                                                       	|  3.6e-05        	|  4              	|  0.000144       	|  0.00024423     	|
|  [LightningModule]PL_module.configure_optimizers                                                                                                                                                           	|  0.0001269      	|  1              	|  0.0001269      	|  0.00021523     	|
|  [Callback]ModelSummary.on_train_epoch_start                                                                                                                                                               	|  2.4767e-05     	|  3              	|  7.43e-05       	|  0.00012602     	|
|  [Callback]ModelSummary.on_validation_end                                                                                                                                                                  	|  1.5025e-05     	|  4              	|  6.01e-05       	|  0.00010193     	|
|  [Callback]ModelSummary.on_train_epoch_end                                                                                                                                                                 	|  1.7667e-05     	|  3              	|  5.3e-05        	|  8.9892e-05     	|
|  [Callback]TQDMProgressBar.on_epoch_start                                                                                                                                                                  	|  6.2e-06        	|  7              	|  4.34e-05       	|  7.3609e-05     	|
|  [Callback]GradientAccumulationScheduler.on_train_epoch_start                                                                                                                                              	|  1.4433e-05     	|  3              	|  4.33e-05       	|  7.344e-05      	|
|  [Callback]ModelSummary.on_validation_start                                                                                                                                                                	|  9.775e-06      	|  4              	|  3.91e-05       	|  6.6316e-05     	|
|  [Callback]ModelSummary.on_epoch_start                                                                                                                                                                     	|  4.4857e-06     	|  7              	|  3.14e-05       	|  5.3257e-05     	|
|  [Callback]ModelSummary.on_epoch_end                                                                                                                                                                       	|  4.4714e-06     	|  7              	|  3.13e-05       	|  5.3087e-05     	|
|  [Callback]TQDMProgressBar.on_epoch_end                                                                                                                                                                    	|  4.4143e-06     	|  7              	|  3.09e-05       	|  5.2409e-05     	|
|  [Callback]GradientAccumulationScheduler.on_epoch_start                                                                                                                                                    	|  4.3714e-06     	|  7              	|  3.06e-05       	|  5.19e-05       	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_epoch_start                     	|  4.3429e-06     	|  7              	|  3.04e-05       	|  5.1561e-05     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_epoch_end                       	|  3.7e-06        	|  7              	|  2.59e-05       	|  4.3928e-05     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_train_epoch_start               	|  8.6333e-06     	|  3              	|  2.59e-05       	|  4.3928e-05     	|
|  [Callback]TQDMProgressBar.on_validation_epoch_end                                                                                                                                                         	|  6.3e-06        	|  4              	|  2.52e-05       	|  4.2741e-05     	|
|  [Callback]GradientAccumulationScheduler.on_epoch_end                                                                                                                                                      	|  3.5143e-06     	|  7              	|  2.46e-05       	|  4.1723e-05     	|
|  [Callback]GradientAccumulationScheduler.on_validation_end                                                                                                                                                 	|  5.325e-06      	|  4              	|  2.13e-05       	|  3.6126e-05     	|
|  [Callback]TQDMProgressBar.on_save_checkpoint                                                                                                                                                              	|  6.5e-06        	|  3              	|  1.95e-05       	|  3.3073e-05     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_validation_start                	|  4.775e-06      	|  4              	|  1.91e-05       	|  3.2395e-05     	|
|  [Callback]ModelSummary.on_sanity_check_start                                                                                                                                                              	|  1.83e-05       	|  1              	|  1.83e-05       	|  3.1038e-05     	|
|  [Callback]GradientAccumulationScheduler.on_fit_start                                                                                                                                                      	|  1.82e-05       	|  1              	|  1.82e-05       	|  3.0868e-05     	|
|  [Callback]GradientAccumulationScheduler.on_validation_epoch_end                                                                                                                                           	|  4.25e-06       	|  4              	|  1.7e-05        	|  2.8833e-05     	|
|  [Callback]GradientAccumulationScheduler.on_validation_start                                                                                                                                               	|  4.225e-06      	|  4              	|  1.69e-05       	|  2.8664e-05     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_validation_epoch_end            	|  4.2e-06        	|  4              	|  1.68e-05       	|  2.8494e-05     	|
|  [Callback]TQDMProgressBar.on_validation_epoch_start                                                                                                                                                       	|  4.1e-06        	|  4              	|  1.64e-05       	|  2.7816e-05     	|
|  [Callback]ModelSummary.on_validation_epoch_end                                                                                                                                                            	|  4.1e-06        	|  4              	|  1.64e-05       	|  2.7816e-05     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_validation_epoch_start          	|  3.825e-06      	|  4              	|  1.53e-05       	|  2.595e-05      	|
|  [Callback]ModelSummary.on_validation_epoch_start                                                                                                                                                          	|  3.625e-06      	|  4              	|  1.45e-05       	|  2.4593e-05     	|
|  [Callback]GradientAccumulationScheduler.on_train_epoch_end                                                                                                                                                	|  4.8333e-06     	|  3              	|  1.45e-05       	|  2.4593e-05     	|
|  [LightningModule]PL_module.on_validation_end                                                                                                                                                              	|  3.5e-06        	|  4              	|  1.4e-05        	|  2.3745e-05     	|
|  [Callback]GradientAccumulationScheduler.on_validation_epoch_start                                                                                                                                         	|  3.475e-06      	|  4              	|  1.39e-05       	|  2.3575e-05     	|
|  [Callback]ModelSummary.on_train_start                                                                                                                                                                     	|  1.37e-05       	|  1              	|  1.37e-05       	|  2.3236e-05     	|
|  [LightningModule]PL_module.on_epoch_start                                                                                                                                                                 	|  1.8429e-06     	|  7              	|  1.29e-05       	|  2.1879e-05     	|
|  [LightningModule]PL_module.validation_epoch_end                                                                                                                                                           	|  3.125e-06      	|  4              	|  1.25e-05       	|  2.1201e-05     	|
|  [Callback]TQDMProgressBar.on_fit_end                                                                                                                                                                      	|  1.24e-05       	|  1              	|  1.24e-05       	|  2.1031e-05     	|
|  [Callback]GradientAccumulationScheduler.on_fit_end                                                                                                                                                        	|  1.24e-05       	|  1              	|  1.24e-05       	|  2.1031e-05     	|
|  [Callback]TQDMProgressBar.setup                                                                                                                                                                           	|  1.22e-05       	|  1              	|  1.22e-05       	|  2.0692e-05     	|
|  [LightningModule]PL_module.on_epoch_end                                                                                                                                                                   	|  1.6429e-06     	|  7              	|  1.15e-05       	|  1.9505e-05     	|
|  [Callback]ModelSummary.on_save_checkpoint                                                                                                                                                                 	|  3.7e-06        	|  3              	|  1.11e-05       	|  1.8826e-05     	|
|  [Callback]TQDMProgressBar.teardown                                                                                                                                                                        	|  1.09e-05       	|  1              	|  1.09e-05       	|  1.8487e-05     	|
|  [Callback]TQDMProgressBar.on_sanity_check_end                                                                                                                                                             	|  1.05e-05       	|  1              	|  1.05e-05       	|  1.7809e-05     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_save_checkpoint                 	|  3.4e-06        	|  3              	|  1.02e-05       	|  1.73e-05       	|
|  [Callback]GradientAccumulationScheduler.on_save_checkpoint                                                                                                                                                	|  3.1333e-06     	|  3              	|  9.4e-06        	|  1.5943e-05     	|
|  [Callback]GradientAccumulationScheduler.on_sanity_check_end                                                                                                                                               	|  9.2e-06        	|  1              	|  9.2e-06        	|  1.5604e-05     	|
|  [Callback]ModelSummary.on_train_end                                                                                                                                                                       	|  9.2e-06        	|  1              	|  9.2e-06        	|  1.5604e-05     	|
|  [Callback]ModelSummary.on_sanity_check_end                                                                                                                                                                	|  8.7e-06        	|  1              	|  8.7e-06        	|  1.4756e-05     	|
|  [Callback]TQDMProgressBar.on_fit_start                                                                                                                                                                    	|  8.3e-06        	|  1              	|  8.3e-06        	|  1.4077e-05     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': None}.on_before_accelerator_backend_setup	|  8.2e-06        	|  1              	|  8.2e-06        	|  1.3908e-05     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_pretrain_routine_start          	|  7.9e-06        	|  1              	|  7.9e-06        	|  1.3399e-05     	|
|  [LightningModule]PL_module.on_fit_start                                                                                                                                                                   	|  7.8e-06        	|  1              	|  7.8e-06        	|  1.3229e-05     	|
|  [Strategy]SingleDeviceStrategy.on_validation_start                                                                                                                                                        	|  1.95e-06       	|  4              	|  7.8e-06        	|  1.3229e-05     	|
|  [Strategy]SingleDeviceStrategy.on_validation_end                                                                                                                                                          	|  1.925e-06      	|  4              	|  7.7e-06        	|  1.306e-05      	|
|  [LightningModule]PL_module.on_train_epoch_start                                                                                                                                                           	|  2.5667e-06     	|  3              	|  7.7e-06        	|  1.306e-05      	|
|  [LightningModule]PL_module.on_validation_start                                                                                                                                                            	|  1.9e-06        	|  4              	|  7.6e-06        	|  1.289e-05      	|
|  [Callback]TQDMProgressBar.on_before_accelerator_backend_setup                                                                                                                                             	|  7.3e-06        	|  1              	|  7.3e-06        	|  1.2381e-05     	|
|  [Callback]TQDMProgressBar.on_pretrain_routine_start                                                                                                                                                       	|  7.3e-06        	|  1              	|  7.3e-06        	|  1.2381e-05     	|
|  [LightningModule]PL_module.on_validation_epoch_end                                                                                                                                                        	|  1.775e-06      	|  4              	|  7.1e-06        	|  1.2042e-05     	|
|  [LightningModule]PL_module.on_train_epoch_end                                                                                                                                                             	|  2.3667e-06     	|  3              	|  7.1e-06        	|  1.2042e-05     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.teardown                           	|  6.8e-06        	|  1              	|  6.8e-06        	|  1.1533e-05     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_sanity_check_start              	|  6.7e-06        	|  1              	|  6.7e-06        	|  1.1364e-05     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_fit_end                         	|  6.3e-06        	|  1              	|  6.3e-06        	|  1.0685e-05     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_train_start                     	|  6.2e-06        	|  1              	|  6.2e-06        	|  1.0516e-05     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_sanity_check_end                	|  5.8e-06        	|  1              	|  5.8e-06        	|  9.8372e-06     	|
|  [LightningModule]PL_module.on_validation_epoch_start                                                                                                                                                      	|  1.425e-06      	|  4              	|  5.7e-06        	|  9.6676e-06     	|
|  [Callback]GradientAccumulationScheduler.on_before_accelerator_backend_setup                                                                                                                               	|  5.2e-06        	|  1              	|  5.2e-06        	|  8.8196e-06     	|
|  [Callback]TQDMProgressBar.on_configure_sharded_model                                                                                                                                                      	|  5.2e-06        	|  1              	|  5.2e-06        	|  8.8196e-06     	|
|  [Callback]GradientAccumulationScheduler.on_sanity_check_start                                                                                                                                             	|  5.1e-06        	|  1              	|  5.1e-06        	|  8.65e-06       	|
|  [Callback]ModelSummary.on_before_accelerator_backend_setup                                                                                                                                                	|  5.1e-06        	|  1              	|  5.1e-06        	|  8.65e-06       	|
|  [LightningModule]PL_module.on_save_checkpoint                                                                                                                                                             	|  1.7e-06        	|  3              	|  5.1e-06        	|  8.65e-06       	|
|  [Callback]ModelSummary.teardown                                                                                                                                                                           	|  5.1e-06        	|  1              	|  5.1e-06        	|  8.65e-06       	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_fit_start                       	|  4.9e-06        	|  1              	|  4.9e-06        	|  8.3107e-06     	|
|  [LightningModule]PL_module.setup                                                                                                                                                                          	|  4.7e-06        	|  1              	|  4.7e-06        	|  7.9715e-06     	|
|  [Callback]GradientAccumulationScheduler.on_train_start                                                                                                                                                    	|  4.7e-06        	|  1              	|  4.7e-06        	|  7.9715e-06     	|
|  [Callback]ModelSummary.on_fit_end                                                                                                                                                                         	|  4.6e-06        	|  1              	|  4.6e-06        	|  7.8019e-06     	|
|  [Callback]TQDMProgressBar.on_pretrain_routine_end                                                                                                                                                         	|  4.5e-06        	|  1              	|  4.5e-06        	|  7.6323e-06     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_configure_sharded_model         	|  4.1e-06        	|  1              	|  4.1e-06        	|  6.9539e-06     	|
|  [Callback]ModelSummary.on_pretrain_routine_start                                                                                                                                                          	|  4.1e-06        	|  1              	|  4.1e-06        	|  6.9539e-06     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_pretrain_routine_end            	|  4.1e-06        	|  1              	|  4.1e-06        	|  6.9539e-06     	|
|  [LightningModule]PL_module.configure_callbacks                                                                                                                                                            	|  4e-06          	|  1              	|  4e-06          	|  6.7843e-06     	|
|  [Callback]ModelSummary.on_pretrain_routine_end                                                                                                                                                            	|  4e-06          	|  1              	|  4e-06          	|  6.7843e-06     	|
|  [Callback]GradientAccumulationScheduler.on_pretrain_routine_end                                                                                                                                           	|  3.9e-06        	|  1              	|  3.9e-06        	|  6.6147e-06     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_train_end                       	|  3.9e-06        	|  1              	|  3.9e-06        	|  6.6147e-06     	|
|  [Callback]GradientAccumulationScheduler.setup                                                                                                                                                             	|  3.8e-06        	|  1              	|  3.8e-06        	|  6.4451e-06     	|
|  [Callback]GradientAccumulationScheduler.on_train_end                                                                                                                                                      	|  3.8e-06        	|  1              	|  3.8e-06        	|  6.4451e-06     	|
|  [Callback]ModelSummary.setup                                                                                                                                                                              	|  3.8e-06        	|  1              	|  3.8e-06        	|  6.4451e-06     	|
|  [Callback]ModelSummary.on_configure_sharded_model                                                                                                                                                         	|  3.7e-06        	|  1              	|  3.7e-06        	|  6.2755e-06     	|
|  [LightningModule]PL_module.prepare_data                                                                                                                                                                   	|  3.6e-06        	|  1              	|  3.6e-06        	|  6.1059e-06     	|
|  [Callback]GradientAccumulationScheduler.on_pretrain_routine_start                                                                                                                                         	|  3.6e-06        	|  1              	|  3.6e-06        	|  6.1059e-06     	|
|  [LightningModule]PL_module.configure_sharded_model                                                                                                                                                        	|  3.6e-06        	|  1              	|  3.6e-06        	|  6.1059e-06     	|
|  [Callback]GradientAccumulationScheduler.on_configure_sharded_model                                                                                                                                        	|  3.3e-06        	|  1              	|  3.3e-06        	|  5.597e-06      	|
|  [LightningModule]PL_module.on_train_dataloader                                                                                                                                                            	|  3e-06          	|  1              	|  3e-06          	|  5.0882e-06     	|
|  [Callback]GradientAccumulationScheduler.teardown                                                                                                                                                          	|  3e-06          	|  1              	|  3e-06          	|  5.0882e-06     	|
|  [LightningModule]PL_module.on_val_dataloader                                                                                                                                                              	|  2.6e-06        	|  1              	|  2.6e-06        	|  4.4098e-06     	|
|  [LightningModule]PL_module.teardown                                                                                                                                                                       	|  2.5e-06        	|  1              	|  2.5e-06        	|  4.2402e-06     	|
|  [LightningModule]PL_module.on_fit_end                                                                                                                                                                     	|  2.4e-06        	|  1              	|  2.4e-06        	|  4.0706e-06     	|
|  [LightningModule]PL_module.on_train_start                                                                                                                                                                 	|  2.1e-06        	|  1              	|  2.1e-06        	|  3.5617e-06     	|
|  [LightningModule]PL_module.on_pretrain_routine_start                                                                                                                                                      	|  2e-06          	|  1              	|  2e-06          	|  3.3921e-06     	|
|  [LightningModule]PL_module.on_train_end                                                                                                                                                                   	|  2e-06          	|  1              	|  2e-06          	|  3.3921e-06     	|
|  [Strategy]SingleDeviceStrategy.on_train_start                                                                                                                                                             	|  1.7e-06        	|  1              	|  1.7e-06        	|  2.8833e-06     	|
|  [LightningModule]PL_module.on_pretrain_routine_end                                                                                                                                                        	|  1.6e-06        	|  1              	|  1.6e-06        	|  2.7137e-06     	|
|  [Strategy]SingleDeviceStrategy.on_train_end                                                                                                                                                               	|  1.4e-06        	|  1              	|  1.4e-06        	|  2.3745e-06     	|

Testing DataLoader 0:  12%|███▌                         | 38/312 [00:00<00:01, 155.97it/s]
Traceback (most recent call last):
  File "/home/xps/educate/code/hust/ML/PL_tutorial/Basic/logger.py", line 118, in <module>
    trainer.test(model, test_loader)
  File "/home/xps/anaconda3/envs/deeplearning/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 936, in test
    return self._call_and_handle_interrupt(self._test_impl, model, dataloaders, ckpt_path, verbose, datamodule)
  File "/home/xps/anaconda3/envs/deeplearning/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 721, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/xps/anaconda3/envs/deeplearning/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 983, in _test_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/xps/anaconda3/envs/deeplearning/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 1234, in _run
    results = self._run_stage()
  File "/home/xps/anaconda3/envs/deeplearning/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 1318, in _run_stage
    return self._run_evaluate()
  File "/home/xps/anaconda3/envs/deeplearning/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 1363, in _run_evaluate
    eval_loop_results = self._evaluation_loop.run()
  File "/home/xps/anaconda3/envs/deeplearning/lib/python3.9/site-packages/pytorch_lightning/loops/base.py", line 211, in run
    output = self.on_run_end()
  File "/home/xps/anaconda3/envs/deeplearning/lib/python3.9/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 188, in on_run_end
    self._evaluation_epoch_end(self._outputs)
  File "/home/xps/anaconda3/envs/deeplearning/lib/python3.9/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 308, in _evaluation_epoch_end
    self.trainer._call_lightning_module_hook("test_epoch_end", output_or_outputs)
  File "/home/xps/anaconda3/envs/deeplearning/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 1593, in _call_lightning_module_hook
    output = fn(*args, **kwargs)
  File "/home/xps/educate/code/hust/ML/PL_tutorial/Basic/logger.py", line 93, in test_epoch_end
    pred = torch.argmax(torch.cat([output['loss'] for output in outputs], dim=0), dim=-1)


