data and label torch.Size([1, 28, 28]) 8
Epoch 0:   8%|█▏              | 146/1875 [00:01<00:17, 100.94it/s, loss=0.404, v_num=0itb]
GPU available: False, used: False
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
  | Name  | Type  | Params
--------------------------------
0 | model | Model | 7.9 K
--------------------------------
7.9 K     Trainable params
0         Non-trainable params
7.9 K     Total params






Epoch 0:  80%|████████████▊   | 1507/1875 [00:15<00:03, 97.21it/s, loss=0.405, v_num=0itb]









Epoch 1:  84%|███████████████   | 1569/1875 [00:16<00:03, 92.50it/s, loss=0.4, v_num=0itb]









Epoch 2:  92%|██████████████▋ | 1727/1875 [00:17<00:01, 98.46it/s, loss=0.396, v_num=0itb]

Testing DataLoader 0:   0%|                                       | 0/312 [00:00<?, ?it/s]
FIT Profiler Report
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
|  Action                                                                                                                                                                                                    	|  Mean duration (s)	|  Num calls      	|  Total time (s) 	|  Percentage %   	|
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
|  Total                                                                                                                                                                                                     	|  -              	|  200563         	|  57.055         	|  100 %          	|
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
|  run_training_epoch                                                                                                                                                                                        	|  18.969         	|  3              	|  56.908         	|  99.743         	|
|  run_training_batch                                                                                                                                                                                        	|  0.0025656      	|  4500           	|  11.545         	|  20.235         	|
|  [LightningModule]PL_module.optimizer_step                                                                                                                                                                 	|  0.0022369      	|  4500           	|  10.066         	|  17.643         	|
|  on_train_batch_end                                                                                                                                                                                        	|  0.0011864      	|  4500           	|  5.3388         	|  9.3573         	|
|  [Strategy]SingleDeviceStrategy.training_step                                                                                                                                                              	|  0.00071099     	|  4500           	|  3.1995         	|  5.6077         	|
|  [Strategy]SingleDeviceStrategy.backward                                                                                                                                                                   	|  0.00049625     	|  4500           	|  2.2331         	|  3.914          	|
|  [Callback]TQDMProgressBar.on_validation_batch_end                                                                                                                                                         	|  0.00087695     	|  1127           	|  0.98832        	|  1.7322         	|
|  on_train_batch_start                                                                                                                                                                                      	|  0.00019174     	|  4500           	|  0.86285        	|  1.5123         	|
|  [Strategy]SingleDeviceStrategy.validation_step                                                                                                                                                            	|  0.00075934     	|  1127           	|  0.85577        	|  1.4999         	|
|  [LightningModule]PL_module.optimizer_zero_grad                                                                                                                                                            	|  0.0001018      	|  4500           	|  0.45808        	|  0.80288        	|
|  [Strategy]SingleDeviceStrategy.batch_to_device                                                                                                                                                            	|  5.3099e-05     	|  5627           	|  0.29879        	|  0.52369        	|
|  [Callback]TQDMProgressBar.on_after_backward                                                                                                                                                               	|  6.2163e-06     	|  4500           	|  0.027973       	|  0.049029       	|
|  [Callback]TQDMProgressBar.on_before_zero_grad                                                                                                                                                             	|  5.7999e-06     	|  4500           	|  0.0261         	|  0.045745       	|
|  [Callback]TQDMProgressBar.on_batch_start                                                                                                                                                                  	|  5.5541e-06     	|  4500           	|  0.024993       	|  0.043806       	|
|  [Callback]TQDMProgressBar.on_batch_end                                                                                                                                                                    	|  5.2683e-06     	|  4500           	|  0.023707       	|  0.041552       	|
|  [Callback]TQDMProgressBar.on_before_optimizer_step                                                                                                                                                        	|  4.77e-06       	|  4500           	|  0.021465       	|  0.037622       	|
|  [Callback]TQDMProgressBar.on_before_backward                                                                                                                                                              	|  4.4317e-06     	|  4500           	|  0.019943       	|  0.034953       	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_batch_end                       	|  4.2756e-06     	|  4500           	|  0.01924        	|  0.033722       	|
|  [Callback]ModelSummary.on_after_backward                                                                                                                                                                  	|  4.0959e-06     	|  4500           	|  0.018431       	|  0.032305       	|
|  [Callback]ModelSummary.on_batch_end                                                                                                                                                                       	|  4.0834e-06     	|  4500           	|  0.018375       	|  0.032206       	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_batch_start                     	|  4.0449e-06     	|  4500           	|  0.018202       	|  0.031903       	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_before_zero_grad                	|  4.0009e-06     	|  4500           	|  0.018004       	|  0.031555       	|
|  [Callback]ModelSummary.on_batch_start                                                                                                                                                                     	|  3.9703e-06     	|  4500           	|  0.017866       	|  0.031314       	|
|  [Callback]ModelSummary.on_before_zero_grad                                                                                                                                                                	|  3.9477e-06     	|  4500           	|  0.017765       	|  0.031136       	|
|  [Callback]GradientAccumulationScheduler.on_batch_end                                                                                                                                                      	|  3.911e-06      	|  4500           	|  0.0176         	|  0.030847       	|
|  [Callback]ModelSummary.on_validation_batch_end                                                                                                                                                            	|  1.5488e-05     	|  1127           	|  0.017455       	|  0.030593       	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_after_backward                  	|  3.794e-06      	|  4500           	|  0.017073       	|  0.029924       	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_before_backward                 	|  3.7472e-06     	|  4500           	|  0.016862       	|  0.029555       	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_before_optimizer_step           	|  3.5553e-06     	|  4500           	|  0.015999       	|  0.028041       	|
|  [Callback]GradientAccumulationScheduler.on_before_zero_grad                                                                                                                                               	|  3.5424e-06     	|  4500           	|  0.015941       	|  0.027939       	|
|  [Callback]GradientAccumulationScheduler.on_after_backward                                                                                                                                                 	|  3.5412e-06     	|  4500           	|  0.015935       	|  0.02793        	|
|  [Callback]ModelSummary.on_before_optimizer_step                                                                                                                                                           	|  3.5342e-06     	|  4500           	|  0.015904       	|  0.027875       	|
|  [Callback]GradientAccumulationScheduler.on_batch_start                                                                                                                                                    	|  3.5036e-06     	|  4500           	|  0.015766       	|  0.027633       	|
|  [Callback]ModelSummary.on_before_backward                                                                                                                                                                 	|  3.4728e-06     	|  4500           	|  0.015627       	|  0.02739        	|
|  [Callback]GradientAccumulationScheduler.on_before_optimizer_step                                                                                                                                          	|  3.4589e-06     	|  4500           	|  0.015565       	|  0.027281       	|
|  [Callback]GradientAccumulationScheduler.on_before_backward                                                                                                                                                	|  3.3494e-06     	|  4500           	|  0.015072       	|  0.026417       	|
|  [Callback]TQDMProgressBar.on_validation_batch_start                                                                                                                                                       	|  1.0864e-05     	|  1127           	|  0.012244       	|  0.02146        	|
|  [LightningModule]PL_module.on_train_batch_end                                                                                                                                                             	|  2.667e-06      	|  4500           	|  0.012002       	|  0.021035       	|
|  [LightningModule]PL_module.training_step_end                                                                                                                                                              	|  2.4174e-06     	|  4500           	|  0.010878       	|  0.019066       	|
|  [LightningModule]PL_module.on_train_batch_start                                                                                                                                                           	|  2.1734e-06     	|  4500           	|  0.0097803      	|  0.017142       	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_train_epoch_end                 	|  0.0031733      	|  3              	|  0.00952        	|  0.016686       	|
|  [LightningModule]PL_module.on_before_zero_grad                                                                                                                                                            	|  1.9705e-06     	|  4500           	|  0.0088673      	|  0.015542       	|
|  [Strategy]SingleDeviceStrategy.training_step_end                                                                                                                                                          	|  1.8952e-06     	|  4500           	|  0.0085283      	|  0.014948       	|
|  [Strategy]SingleDeviceStrategy.on_train_batch_start                                                                                                                                                       	|  1.757e-06      	|  4500           	|  0.0079063      	|  0.013857       	|
|  [LightningModule]PL_module.on_after_backward                                                                                                                                                              	|  1.6767e-06     	|  4500           	|  0.0075453      	|  0.013225       	|
|  [LightningModule]PL_module.on_before_backward                                                                                                                                                             	|  1.6652e-06     	|  4500           	|  0.0074936      	|  0.013134       	|
|  [Callback]GradientAccumulationScheduler.on_validation_batch_end                                                                                                                                           	|  6.2647e-06     	|  1127           	|  0.0070603      	|  0.012375       	|
|  [LightningModule]PL_module.training_epoch_end                                                                                                                                                             	|  0.0021829      	|  3              	|  0.0065488      	|  0.011478       	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_validation_batch_end            	|  5.6675e-06     	|  1127           	|  0.0063873      	|  0.011195       	|
|  [LightningModule]PL_module.on_before_optimizer_step                                                                                                                                                       	|  1.3806e-06     	|  4500           	|  0.0062126      	|  0.010889       	|
|  [Callback]ModelSummary.on_validation_batch_start                                                                                                                                                          	|  4.6971e-06     	|  1127           	|  0.0052936      	|  0.0092781      	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_validation_batch_start          	|  4.1666e-06     	|  1127           	|  0.0046958      	|  0.0082303      	|
|  [Callback]GradientAccumulationScheduler.on_validation_batch_start                                                                                                                                         	|  3.8251e-06     	|  1127           	|  0.0043109      	|  0.0075557      	|
|  [Callback]TQDMProgressBar.on_validation_end                                                                                                                                                               	|  0.0008036      	|  4              	|  0.0032144      	|  0.0056339      	|
|  [LightningModule]PL_module.validation_step_end                                                                                                                                                            	|  2.5675e-06     	|  1127           	|  0.0028936      	|  0.0050716      	|
|  [LightningModule]PL_module.on_validation_batch_end                                                                                                                                                        	|  2.5411e-06     	|  1127           	|  0.0028638      	|  0.0050194      	|
|  [LightningModule]PL_module.on_validation_batch_start                                                                                                                                                      	|  1.9473e-06     	|  1127           	|  0.0021946      	|  0.0038465      	|
|  [Strategy]SingleDeviceStrategy.validation_step_end                                                                                                                                                        	|  1.8472e-06     	|  1127           	|  0.0020818      	|  0.0036488      	|
|  [Callback]TQDMProgressBar.on_train_epoch_end                                                                                                                                                              	|  0.000688       	|  3              	|  0.002064       	|  0.0036176      	|
|  [Callback]TQDMProgressBar.on_train_epoch_start                                                                                                                                                            	|  0.0006607      	|  3              	|  0.0019821      	|  0.003474       	|
|  [Callback]TQDMProgressBar.on_validation_start                                                                                                                                                             	|  0.0003739      	|  4              	|  0.0014956      	|  0.0026213      	|
|  [Callback]TQDMProgressBar.on_sanity_check_start                                                                                                                                                           	|  0.0009513      	|  1              	|  0.0009513      	|  0.0016673      	|
|  [Callback]ModelSummary.on_fit_start                                                                                                                                                                       	|  0.0006449      	|  1              	|  0.0006449      	|  0.0011303      	|
|  [Callback]TQDMProgressBar.on_train_end                                                                                                                                                                    	|  0.0005171      	|  1              	|  0.0005171      	|  0.00090632     	|
|  [Callback]TQDMProgressBar.on_train_start                                                                                                                                                                  	|  0.0002573      	|  1              	|  0.0002573      	|  0.00045097     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': None}.setup                              	|  0.000231       	|  1              	|  0.000231       	|  0.00040487     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_validation_end                  	|  4.6575e-05     	|  4              	|  0.0001863      	|  0.00032653     	|
|  [LightningModule]PL_module.on_validation_model_train                                                                                                                                                      	|  4.215e-05      	|  4              	|  0.0001686      	|  0.00029551     	|
|  [LightningModule]PL_module.on_validation_model_eval                                                                                                                                                       	|  3.2575e-05     	|  4              	|  0.0001303      	|  0.00022838     	|
|  [LightningModule]PL_module.configure_optimizers                                                                                                                                                           	|  0.0001269      	|  1              	|  0.0001269      	|  0.00022242     	|
|  [Callback]ModelSummary.on_validation_end                                                                                                                                                                  	|  1.62e-05       	|  4              	|  6.48e-05       	|  0.00011358     	|
|  [Callback]TQDMProgressBar.on_epoch_end                                                                                                                                                                    	|  9.1e-06        	|  7              	|  6.37e-05       	|  0.00011165     	|
|  [Callback]ModelSummary.on_validation_start                                                                                                                                                                	|  1.4175e-05     	|  4              	|  5.67e-05       	|  9.9378e-05     	|
|  [Callback]ModelSummary.on_train_epoch_start                                                                                                                                                               	|  1.43e-05       	|  3              	|  4.29e-05       	|  7.5191e-05     	|
|  [Callback]ModelSummary.on_epoch_end                                                                                                                                                                       	|  5.1143e-06     	|  7              	|  3.58e-05       	|  6.2747e-05     	|
|  [Callback]GradientAccumulationScheduler.on_train_epoch_start                                                                                                                                              	|  1.1533e-05     	|  3              	|  3.46e-05       	|  6.0643e-05     	|
|  [Callback]TQDMProgressBar.on_epoch_start                                                                                                                                                                  	|  4.9e-06        	|  7              	|  3.43e-05       	|  6.0118e-05     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_epoch_start                     	|  4.8714e-06     	|  7              	|  3.41e-05       	|  5.9767e-05     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_epoch_end                       	|  4.3571e-06     	|  7              	|  3.05e-05       	|  5.3457e-05     	|
|  [Callback]ModelSummary.on_train_epoch_end                                                                                                                                                                 	|  9.9667e-06     	|  3              	|  2.99e-05       	|  5.2406e-05     	|
|  [Callback]GradientAccumulationScheduler.on_epoch_end                                                                                                                                                      	|  4.2143e-06     	|  7              	|  2.95e-05       	|  5.1705e-05     	|
|  [Callback]GradientAccumulationScheduler.on_epoch_start                                                                                                                                                    	|  4e-06          	|  7              	|  2.8e-05        	|  4.9076e-05     	|
|  [Callback]ModelSummary.on_epoch_start                                                                                                                                                                     	|  3.9714e-06     	|  7              	|  2.78e-05       	|  4.8725e-05     	|
|  [Callback]TQDMProgressBar.on_validation_epoch_end                                                                                                                                                         	|  6.7e-06        	|  4              	|  2.68e-05       	|  4.6972e-05     	|
|  [Callback]GradientAccumulationScheduler.on_validation_start                                                                                                                                               	|  5.45e-06       	|  4              	|  2.18e-05       	|  3.8209e-05     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_validation_epoch_end            	|  5.325e-06      	|  4              	|  2.13e-05       	|  3.7333e-05     	|
|  [Callback]ModelSummary.on_validation_epoch_start                                                                                                                                                          	|  5e-06          	|  4              	|  2e-05          	|  3.5054e-05     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_validation_start                	|  5e-06          	|  4              	|  2e-05          	|  3.5054e-05     	|
|  [Callback]TQDMProgressBar.on_sanity_check_end                                                                                                                                                             	|  1.99e-05       	|  1              	|  1.99e-05       	|  3.4879e-05     	|
|  [Callback]GradientAccumulationScheduler.on_validation_epoch_end                                                                                                                                           	|  4.875e-06      	|  4              	|  1.95e-05       	|  3.4178e-05     	|
|  [Callback]ModelSummary.on_validation_epoch_end                                                                                                                                                            	|  4.775e-06      	|  4              	|  1.91e-05       	|  3.3477e-05     	|
|  [Callback]GradientAccumulationScheduler.on_validation_end                                                                                                                                                 	|  4.65e-06       	|  4              	|  1.86e-05       	|  3.26e-05       	|
|  [Callback]TQDMProgressBar.on_validation_epoch_start                                                                                                                                                       	|  4.625e-06      	|  4              	|  1.85e-05       	|  3.2425e-05     	|
|  [Callback]GradientAccumulationScheduler.on_validation_epoch_start                                                                                                                                         	|  4.225e-06      	|  4              	|  1.69e-05       	|  2.9621e-05     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_train_epoch_start               	|  5.3667e-06     	|  3              	|  1.61e-05       	|  2.8218e-05     	|
|  [Callback]TQDMProgressBar.on_save_checkpoint                                                                                                                                                              	|  5.3667e-06     	|  3              	|  1.61e-05       	|  2.8218e-05     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_validation_epoch_start          	|  3.95e-06       	|  4              	|  1.58e-05       	|  2.7693e-05     	|
|  [LightningModule]PL_module.validation_epoch_end                                                                                                                                                           	|  3.825e-06      	|  4              	|  1.53e-05       	|  2.6816e-05     	|
|  [LightningModule]PL_module.on_epoch_end                                                                                                                                                                   	|  2.0714e-06     	|  7              	|  1.45e-05       	|  2.5414e-05     	|
|  [LightningModule]PL_module.on_epoch_start                                                                                                                                                                 	|  1.9714e-06     	|  7              	|  1.38e-05       	|  2.4187e-05     	|
|  [Callback]ModelSummary.on_train_end                                                                                                                                                                       	|  1.28e-05       	|  1              	|  1.28e-05       	|  2.2435e-05     	|
|  [LightningModule]PL_module.on_validation_end                                                                                                                                                              	|  3.175e-06      	|  4              	|  1.27e-05       	|  2.2259e-05     	|
|  [Callback]ModelSummary.on_sanity_check_start                                                                                                                                                              	|  1.17e-05       	|  1              	|  1.17e-05       	|  2.0507e-05     	|
|  [Callback]GradientAccumulationScheduler.on_train_epoch_end                                                                                                                                                	|  3.8333e-06     	|  3              	|  1.15e-05       	|  2.0156e-05     	|
|  [Callback]TQDMProgressBar.setup                                                                                                                                                                           	|  1.14e-05       	|  1              	|  1.14e-05       	|  1.9981e-05     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_save_checkpoint                 	|  3.6667e-06     	|  3              	|  1.1e-05        	|  1.928e-05      	|
|  [Callback]ModelSummary.on_save_checkpoint                                                                                                                                                                 	|  3.6e-06        	|  3              	|  1.08e-05       	|  1.8929e-05     	|
|  [Callback]GradientAccumulationScheduler.on_fit_start                                                                                                                                                      	|  1.07e-05       	|  1              	|  1.07e-05       	|  1.8754e-05     	|
|  [Callback]TQDMProgressBar.on_fit_end                                                                                                                                                                      	|  9e-06          	|  1              	|  9e-06          	|  1.5774e-05     	|
|  [LightningModule]PL_module.on_validation_start                                                                                                                                                            	|  2.225e-06      	|  4              	|  8.9e-06        	|  1.5599e-05     	|
|  [Strategy]SingleDeviceStrategy.on_validation_start                                                                                                                                                        	|  2.225e-06      	|  4              	|  8.9e-06        	|  1.5599e-05     	|
|  [LightningModule]PL_module.on_validation_epoch_end                                                                                                                                                        	|  2.05e-06       	|  4              	|  8.2e-06        	|  1.4372e-05     	|
|  [Callback]GradientAccumulationScheduler.on_save_checkpoint                                                                                                                                                	|  2.7333e-06     	|  3              	|  8.2e-06        	|  1.4372e-05     	|
|  [LightningModule]PL_module.on_train_epoch_start                                                                                                                                                           	|  2.6e-06        	|  3              	|  7.8e-06        	|  1.3671e-05     	|
|  [LightningModule]PL_module.on_train_epoch_end                                                                                                                                                             	|  2.5333e-06     	|  3              	|  7.6e-06        	|  1.3321e-05     	|
|  [Callback]ModelSummary.on_train_start                                                                                                                                                                     	|  7.6e-06        	|  1              	|  7.6e-06        	|  1.3321e-05     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_train_end                       	|  7.5e-06        	|  1              	|  7.5e-06        	|  1.3145e-05     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_sanity_check_start              	|  6.9e-06        	|  1              	|  6.9e-06        	|  1.2094e-05     	|
|  [Strategy]SingleDeviceStrategy.on_validation_end                                                                                                                                                          	|  1.55e-06       	|  4              	|  6.2e-06        	|  1.0867e-05     	|
|  [LightningModule]PL_module.on_validation_epoch_start                                                                                                                                                      	|  1.525e-06      	|  4              	|  6.1e-06        	|  1.0691e-05     	|
|  [Callback]TQDMProgressBar.on_pretrain_routine_start                                                                                                                                                       	|  5.8e-06        	|  1              	|  5.8e-06        	|  1.0166e-05     	|
|  [LightningModule]PL_module.on_save_checkpoint                                                                                                                                                             	|  1.8667e-06     	|  3              	|  5.6e-06        	|  9.8151e-06     	|
|  [Callback]TQDMProgressBar.on_fit_start                                                                                                                                                                    	|  5.5e-06        	|  1              	|  5.5e-06        	|  9.6399e-06     	|
|  [Callback]TQDMProgressBar.teardown                                                                                                                                                                        	|  5.5e-06        	|  1              	|  5.5e-06        	|  9.6399e-06     	|
|  [Callback]GradientAccumulationScheduler.on_sanity_check_start                                                                                                                                             	|  5.3e-06        	|  1              	|  5.3e-06        	|  9.2893e-06     	|
|  [Callback]TQDMProgressBar.on_before_accelerator_backend_setup                                                                                                                                             	|  5.2e-06        	|  1              	|  5.2e-06        	|  9.114e-06      	|
|  [Callback]ModelSummary.on_sanity_check_end                                                                                                                                                                	|  5e-06          	|  1              	|  5e-06          	|  8.7635e-06     	|
|  [LightningModule]PL_module.configure_callbacks                                                                                                                                                            	|  5e-06          	|  1              	|  5e-06          	|  8.7635e-06     	|
|  [Callback]TQDMProgressBar.on_configure_sharded_model                                                                                                                                                      	|  4.9e-06        	|  1              	|  4.9e-06        	|  8.5882e-06     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_fit_start                       	|  4.8e-06        	|  1              	|  4.8e-06        	|  8.413e-06      	|
|  [Callback]GradientAccumulationScheduler.on_train_end                                                                                                                                                      	|  4.8e-06        	|  1              	|  4.8e-06        	|  8.413e-06      	|
|  [LightningModule]PL_module.setup                                                                                                                                                                          	|  4.7e-06        	|  1              	|  4.7e-06        	|  8.2377e-06     	|
|  [LightningModule]PL_module.on_fit_start                                                                                                                                                                   	|  4.6e-06        	|  1              	|  4.6e-06        	|  8.0624e-06     	|
|  [Callback]ModelSummary.setup                                                                                                                                                                              	|  4.3e-06        	|  1              	|  4.3e-06        	|  7.5366e-06     	|
|  [Callback]ModelSummary.on_fit_end                                                                                                                                                                         	|  4.2e-06        	|  1              	|  4.2e-06        	|  7.3613e-06     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.teardown                           	|  4.1e-06        	|  1              	|  4.1e-06        	|  7.1861e-06     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_fit_end                         	|  4.1e-06        	|  1              	|  4.1e-06        	|  7.1861e-06     	|
|  [Callback]ModelSummary.teardown                                                                                                                                                                           	|  4e-06          	|  1              	|  4e-06          	|  7.0108e-06     	|
|  [Callback]ModelSummary.on_before_accelerator_backend_setup                                                                                                                                                	|  3.7e-06        	|  1              	|  3.7e-06        	|  6.485e-06      	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': None}.on_before_accelerator_backend_setup	|  3.7e-06        	|  1              	|  3.7e-06        	|  6.485e-06      	|
|  [Callback]GradientAccumulationScheduler.setup                                                                                                                                                             	|  3.7e-06        	|  1              	|  3.7e-06        	|  6.485e-06      	|
|  [Callback]GradientAccumulationScheduler.on_fit_end                                                                                                                                                        	|  3.7e-06        	|  1              	|  3.7e-06        	|  6.485e-06      	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_configure_sharded_model         	|  3.6e-06        	|  1              	|  3.6e-06        	|  6.3097e-06     	|
|  [Callback]ModelSummary.on_configure_sharded_model                                                                                                                                                         	|  3.6e-06        	|  1              	|  3.6e-06        	|  6.3097e-06     	|
|  [Callback]GradientAccumulationScheduler.on_before_accelerator_backend_setup                                                                                                                               	|  3.5e-06        	|  1              	|  3.5e-06        	|  6.1345e-06     	|
|  [LightningModule]PL_module.on_train_dataloader                                                                                                                                                            	|  3.5e-06        	|  1              	|  3.5e-06        	|  6.1345e-06     	|
|  [Callback]GradientAccumulationScheduler.teardown                                                                                                                                                          	|  3.4e-06        	|  1              	|  3.4e-06        	|  5.9592e-06     	|
|  [Callback]GradientAccumulationScheduler.on_configure_sharded_model                                                                                                                                        	|  3.3e-06        	|  1              	|  3.3e-06        	|  5.7839e-06     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_train_start                     	|  3.3e-06        	|  1              	|  3.3e-06        	|  5.7839e-06     	|
|  [Callback]GradientAccumulationScheduler.on_train_start                                                                                                                                                    	|  3.2e-06        	|  1              	|  3.2e-06        	|  5.6086e-06     	|
|  [LightningModule]PL_module.on_val_dataloader                                                                                                                                                              	|  3.2e-06        	|  1              	|  3.2e-06        	|  5.6086e-06     	|
|  [Callback]ModelSummary.on_pretrain_routine_start                                                                                                                                                          	|  2.9e-06        	|  1              	|  2.9e-06        	|  5.0828e-06     	|
|  [LightningModule]PL_module.prepare_data                                                                                                                                                                   	|  2.9e-06        	|  1              	|  2.9e-06        	|  5.0828e-06     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_pretrain_routine_start          	|  2.8e-06        	|  1              	|  2.8e-06        	|  4.9076e-06     	|
|  [LightningModule]PL_module.on_train_end                                                                                                                                                                   	|  2.8e-06        	|  1              	|  2.8e-06        	|  4.9076e-06     	|
|  [Callback]GradientAccumulationScheduler.on_sanity_check_end                                                                                                                                               	|  2.6e-06        	|  1              	|  2.6e-06        	|  4.557e-06      	|
|  [Callback]GradientAccumulationScheduler.on_pretrain_routine_start                                                                                                                                         	|  2.5e-06        	|  1              	|  2.5e-06        	|  4.3818e-06     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_sanity_check_end                	|  2.5e-06        	|  1              	|  2.5e-06        	|  4.3818e-06     	|
|  [LightningModule]PL_module.configure_sharded_model                                                                                                                                                        	|  2.4e-06        	|  1              	|  2.4e-06        	|  4.2065e-06     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_pretrain_routine_end            	|  2.4e-06        	|  1              	|  2.4e-06        	|  4.2065e-06     	|
|  [LightningModule]PL_module.teardown                                                                                                                                                                       	|  2.3e-06        	|  1              	|  2.3e-06        	|  4.0312e-06     	|
|  [Callback]TQDMProgressBar.on_pretrain_routine_end                                                                                                                                                         	|  2.3e-06        	|  1              	|  2.3e-06        	|  4.0312e-06     	|
|  [Callback]GradientAccumulationScheduler.on_pretrain_routine_end                                                                                                                                           	|  2.1e-06        	|  1              	|  2.1e-06        	|  3.6807e-06     	|
|  [Callback]ModelSummary.on_pretrain_routine_end                                                                                                                                                            	|  2.1e-06        	|  1              	|  2.1e-06        	|  3.6807e-06     	|
|  [Strategy]SingleDeviceStrategy.on_train_end                                                                                                                                                               	|  2e-06          	|  1              	|  2e-06          	|  3.5054e-06     	|
|  [LightningModule]PL_module.on_fit_end                                                                                                                                                                     	|  2e-06          	|  1              	|  2e-06          	|  3.5054e-06     	|
|  [LightningModule]PL_module.on_pretrain_routine_start                                                                                                                                                      	|  1.3e-06        	|  1              	|  1.3e-06        	|  2.2785e-06     	|
|  [LightningModule]PL_module.on_train_start                                                                                                                                                                 	|  1.2e-06        	|  1              	|  1.2e-06        	|  2.1032e-06     	|
|  [Strategy]SingleDeviceStrategy.on_train_start                                                                                                                                                             	|  1.2e-06        	|  1              	|  1.2e-06        	|  2.1032e-06     	|
|  [LightningModule]PL_module.on_pretrain_routine_end                                                                                                                                                        	|  8e-07          	|  1              	|  8e-07          	|  1.4022e-06     	|
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Traceback (most recent call last):
  File "/home/xps/educate/code/hust/ML/PL_tutorial/Basic/logger.py", line 111, in <module>
    trainer.test(model, test_loader)
  File "/home/xps/anaconda3/envs/deeplearning/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 936, in test
    return self._call_and_handle_interrupt(self._test_impl, model, dataloaders, ckpt_path, verbose, datamodule)
  File "/home/xps/anaconda3/envs/deeplearning/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 721, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/xps/anaconda3/envs/deeplearning/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 983, in _test_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/home/xps/anaconda3/envs/deeplearning/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 1234, in _run
    results = self._run_stage()
  File "/home/xps/anaconda3/envs/deeplearning/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 1318, in _run_stage
    return self._run_evaluate()
  File "/home/xps/anaconda3/envs/deeplearning/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 1363, in _run_evaluate
    eval_loop_results = self._evaluation_loop.run()
  File "/home/xps/anaconda3/envs/deeplearning/lib/python3.9/site-packages/pytorch_lightning/loops/base.py", line 204, in run
    self.advance(*args, **kwargs)
  File "/home/xps/anaconda3/envs/deeplearning/lib/python3.9/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 154, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/home/xps/anaconda3/envs/deeplearning/lib/python3.9/site-packages/pytorch_lightning/loops/base.py", line 204, in run
    self.advance(*args, **kwargs)
  File "/home/xps/anaconda3/envs/deeplearning/lib/python3.9/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 127, in advance
    output = self._evaluation_step(**kwargs)
  File "/home/xps/anaconda3/envs/deeplearning/lib/python3.9/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 220, in _evaluation_step
    output = self.trainer._call_strategy_hook("test_step", *kwargs.values())
  File "/home/xps/anaconda3/envs/deeplearning/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 1763, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/xps/anaconda3/envs/deeplearning/lib/python3.9/site-packages/pytorch_lightning/strategies/strategy.py", line 352, in test_step
    return self.model.test_step(*args, **kwargs)
  File "/home/xps/educate/code/hust/ML/PL_tutorial/Basic/logger.py", line 88, in test_step
    self.logger.experiment.log({"Confusion Matrix": wandb_logger.Image(plot)})
